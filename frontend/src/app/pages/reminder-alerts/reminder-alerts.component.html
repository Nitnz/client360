<div class="page-container">

  <!-- ── Header ─────────────────────────────────────── -->
  <div class="page-header">
    <div>
      <div class="page-label">Alerts</div>
      <h2 class="page-title">Reminders</h2>
    </div>
    <div class="header-right">
      <div class="alert-count" *ngIf="!loading && reminders.length > 0">
        {{ reminders.length }} active
      </div>
      <button class="btn-primary" (click)="showForm = !showForm">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        Add Note
      </button>
    </div>
  </div>

  <!-- ── Add Manual Reminder ────────────────────────── -->
  <div class="add-form-panel" [class.open]="showForm">
    <div class="panel-inner">
      <h3 class="panel-title">New Reminder Note</h3>
      <div class="form-grid">
        <div class="field">
          <label>Project / Title</label>
          <input type="text" placeholder="e.g. Client ABC website" [(ngModel)]="newReminder.projectName" />
        </div>
        <div class="field">
          <label>Client Name</label>
          <input type="text" placeholder="e.g. John" [(ngModel)]="newReminder.clientName" />
        </div>
        <div class="field full">
          <label>Note</label>
          <input type="text" placeholder="e.g. Follow up on payment" [(ngModel)]="newReminder.note" />
        </div>
      </div>
      <div class="form-actions">
        <button class="btn-ghost" (click)="showForm = false">Cancel</button>
        <button class="btn-primary" (click)="addReminder()">Save Reminder</button>
      </div>
    </div>
  </div>

  <!-- ── Loading ────────────────────────────────────── -->
  <div class="loading-state" *ngIf="loading">
    <div class="spinner"></div>
    <span>Checking reminders…</span>
  </div>

  <!-- ── Empty ──────────────────────────────────────── -->
  <div class="empty-state" *ngIf="!loading && reminders.length === 0">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.2">
      <polyline points="20 6 9 17 4 12"/>
    </svg>
    <p>No reminders right now</p>
  </div>

  <!-- ── Cards ──────────────────────────────────────── -->
  <div class="card-grid" *ngIf="!loading && reminders.length > 0">
    <div class="reminder-card" *ngFor="let r of reminders" [attr.data-auto]="r.auto">

      <div class="card-top">
        <span class="type-badge" [attr.data-type]="getBadgeClass(r.type)">
          {{ formatType(r.type) }}
        </span>
        <button class="btn-delete" *ngIf="!r.auto" (click)="deleteReminder(r._id)" title="Delete">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <polyline points="3 6 5 6 21 6"/>
            <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/>
            <path d="M10 11v6M14 11v6M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/>
          </svg>
        </button>
      </div>

      <div class="card-project">{{ r.projectName }}</div>

      <div class="card-meta">
        <div class="meta-row" *ngIf="r.clientName">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
            <circle cx="9" cy="7" r="4"/>
          </svg>
          {{ r.clientName }}
        </div>
        <div class="meta-row" *ngIf="r.expiryDate">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
            <rect x="3" y="4" width="18" height="18" rx="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
          </svg>
          {{ r.expiryDate | date:'mediumDate' }}
        </div>
        <div class="meta-row balance" *ngIf="r.balance">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
            <line x1="12" y1="1" x2="12" y2="23"/>
            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
          </svg>
          ₹{{ r.balance }} pending
        </div>
        <div class="meta-row note" *ngIf="r.note">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
          {{ r.note }}
        </div>
      </div>

    </div>
  </div>

</div>